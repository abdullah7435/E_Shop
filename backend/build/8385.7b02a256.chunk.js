"use strict";(self.webpackChunkbackend=self.webpackChunkbackend||[]).push([[8385],{52713:(j,L,s)=>{s.d(L,{r:()=>P});var m=s(67294),p=s(41580),A=s(45697),C=s.n(A),S=s(99168);function k(M,b,h){if(!M||!b)return{display:"none"};const{x:I,y:F}=h;return{transform:`translate(${I}px, ${F}px)`}}function P({renderItem:M}){const{itemType:b,isDragging:h,item:I,initialOffset:F,currentOffset:K,mouseOffset:B}=(0,S.useDragLayer)(O=>({item:O.getItem(),itemType:O.getItemType(),initialOffset:O.getInitialSourceClientOffset(),currentOffset:O.getSourceClientOffset(),isDragging:O.isDragging(),mouseOffset:O.getClientOffset()}));return h?m.createElement(p.x,{height:"100%",left:0,position:"fixed",pointerEvents:"none",top:0,zIndex:100,width:"100%"},m.createElement(p.x,{style:k(F,K,B)},M({type:b,item:I}))):null}P.propTypes={renderItem:C().func.isRequired}},27661:(j,L,s)=>{var m=s(67294);const p=(0,m.createContext)();var A=null},21440:(j,L,s)=>{s.d(L,{PL:()=>S,Y9:()=>k.Y,zE:()=>oe,Ky:()=>le,fi:()=>Z,zH:()=>T,r5:()=>c});var m=s(67294),p=s(86706),A=s(25398);const S=()=>{const n=(0,p.v9)(A.Z),e=(0,m.useCallback)(t=>n?.components?.[t]??{},[n]);return{...n,getComponentLayout:e}};var k=s(79116),P=s(57993),M=s(52861),b=s(42225),h=s(18172);const I={error:null,isLoading:!0,layout:{},layouts:{}},K=(n,e)=>(0,h.ZP)(n,t=>{switch(e.type){case"GET_DATA":{t.isLoading=!0,t.error=null,t.layout={};break}case"GET_DATA_SUCCEEDED":{const i=e.data.contentType.uid;t.layout=e.data,t.layouts[i]=e.data,t.isLoading=!1;break}case"GET_DATA_ERROR":{t.isLoading=!1,t.error=e.error;break}case"SET_LAYOUT_FROM_STATE":{t.error=null,t.layout=n.layouts[e.uid];break}case"UPDATE_LAYOUT":{const i=n.layout;t.layout={...i,contentType:{uid:i.contentType.uid,...e.newLayout.contentType}},t.layouts[i.contentType.uid]={...i,contentType:{uid:i.contentType.uid,...e.newLayout.contentType}};break}default:return t}});var B=s(50361),O=s.n(B),H=s(27361),v=s.n(H),J=s(36968),N=s.n(J),re=s(44949);const X=(n,e)=>e.find(t=>t.uid===n),q=(n,e)=>{const t=w(n,e),i=R(t.contentType,e),l=_(t.contentType,t.components);return N()(t,["contentType","layouts","edit"],i),N()(t,["contentType","layouts","list"],l),Object.keys(t.components).forEach(a=>{const f=R(t.components[a],e);N()(t,["components",a,"layouts","edit"],f)}),t},w=(n,e)=>{const t=(0,re.w8)(O()(n),e,"contentType"),{components:i,contentType:l}=t,a=f=>Object.keys(f.metadatas).reduce((g,D)=>{const E=v()(f,["attributes",D],{});let x=f.metadatas[D];if(E.type==="relation"){const fe=X(E.targetModel,e),W=x.edit.mainField,Q={name:W,schema:v()(fe,["attributes",W])};x={list:{...x.list,mainField:Q},edit:{...x.edit,mainField:Q}}}return g[D]=x,g},{});return N()(t,["contentType","metadatas"],a(l)),Object.keys(i).forEach(f=>{const g=i[f],D=a(g);N()(t,["components",f,"metadatas"],D)}),t},R=(n,e)=>n.layouts.edit.reduce((t,i)=>{const l=i.map(a=>{const f=v()(n,["attributes",a.name],{}),g={...a,fieldSchema:f,metadatas:v()(n,["metadatas",a.name,"edit"],{})};if(f.type==="relation"){const E=X(f.targetModel,e).pluginOptions||{};N()(g,"targetModelPluginOptions",E),N()(g,"queryInfos",{shouldDisplayRelationLink:Y(n,a.name,e)})}return g});return t.push(l),t},[]),_=(n,e)=>n.layouts.list.reduce((i,l)=>{const a=v()(n,["attributes",l],{}),f=v()(n,["metadatas",l,"list"],{}),g=a.type;if(g==="relation")return i.push({key:`__${l}_key__`,name:l,fieldSchema:a,metadatas:f}),i;if(g==="component"){const D=e[a.component],E=D.settings.mainField,x=D.attributes[E];return i.push({key:`__${l}_key__`,name:l,fieldSchema:a,metadatas:{...f,mainField:{...x,name:E}}}),i}return i.push({key:`__${l}_key__`,name:l,fieldSchema:a,metadatas:f}),i},[]),Y=(n,e,t)=>{const i=v()(n,["attributes",e,"targetModel"],"");return U(t).includes(i)},U=n=>n.filter(e=>e.isDisplayed).map(({uid:e})=>e),$=q,oe=n=>{const[{error:e,isLoading:t,layout:i,layouts:l},a]=(0,m.useReducer)(K,I),f=(0,m.useMemo)(b.Vo,[]),{schemas:g}=(0,p.v9)(W=>f(W),p.wU),D=(0,m.useRef)(!0),{get:E}=(0,P.kY)(),x=(0,m.useCallback)(async(W,Q)=>{if(l[W]){a({type:"SET_LAYOUT_FROM_STATE",uid:W});return}a({type:"GET_DATA"});try{const{data:{data:se}}=await E(`/content-manager/content-types/${W}/configuration`,{cancelToken:Q.token});a({type:"GET_DATA_SUCCEEDED",data:$(se,g)})}catch(se){if(M.default.isCancel(se))return;D.current&&console.error(se),D.current&&a({type:"GET_DATA_ERROR",error:se})}},[l,g,E]);(0,m.useEffect)(()=>()=>{D.current=!1},[]),(0,m.useEffect)(()=>{const Q=M.default.CancelToken.source();return x(n,Q),()=>{Q.cancel("Operation canceled by the user.")}},[n,x]);const fe=(0,m.useCallback)(W=>{a({type:"UPDATE_LAYOUT",newLayout:$(W,g)})},[g]);return{error:e,isLoading:t,layout:i,updateLayout:fe}},ae=n=>n["content-manager_app"].collectionTypeLinks;var ie=s(13218),ye=s.n(ie),z=s(80129);const y=(n,e)=>Object.keys(n).reduce((t,i)=>{const l=n[i],a=v()(e,[i],l);return ye()(l)?{...t,[i]:y(l,a)}:(t[i]=a,t)},{}),ue=(n,e,t)=>{const i=n.find(({to:x})=>x.includes(e));if(!i)return"/";const{to:l,search:a}=i,f=(0,z.parse)(a),g=(0,z.parse)(t.substring(1)),D=y(f,g);return`${l}?${(0,z.stringify)(D,{encode:!1})}`},le=n=>{const[{rawQuery:e}]=(0,P.Kx)(),t=(0,p.v9)(ae);return ue(t,n,e)};var pe=s(25950),V=s(16550);const Z=()=>{const{search:n}=(0,V.TH)(),e=n?(0,z.parse)(n.substring(1)):{};return e.plugins?(0,z.stringify)({plugins:e.plugins},{encode:!1}):""},T=n=>{const e=(0,m.useRef)();return(0,m.useEffect)(()=>{e.current=n},[n]),e.current};var G=s(14996);const ce=(n,e,t)=>({type:G.m,permissions:n,__meta__:{plugins:e,containerName:t}}),ne=()=>({type:G.Q}),de=n=>n["content-manager_rbacManager"].permissions,me=n=>n.rbacProvider.collectionTypesRelatedPermissions,c=(n,e,t="listView")=>{const i=(0,p.v9)(me),l=(0,p.v9)(de),a=(0,p.I0)(),f=i[e];return(0,m.useEffect)(()=>f?(a(ce(f,n?n.plugins:null,t)),()=>{a(ne())}):()=>{},[f,a,n,t]),l};var u=s(27661);const o=()=>useContext(WysiwygContext),d=null},79116:(j,L,s)=>{s.d(L,{Y:()=>S});var m=s(67294),p=s(99168),A=s.n(p),C=s(25950);const S=(k,{type:P="STRAPI_DND",index:M,item:b={},onStart:h,onEnd:I,onGrabItem:F,onDropItem:K,onCancel:B,onMoveItem:O,dropSensitivity:H="regular"})=>{const v=(0,m.useRef)(null),[{handlerId:J},N]=(0,p.useDrop)({accept:P,collect(R){return{handlerId:R.getHandlerId()}},hover(R,_){if(!v.current)return;const Y=R.index,U=M;if(Y!==U){if(H==="regular"){const $=v.current.getBoundingClientRect(),ee=($.bottom-$.top)/2,te=_.getClientOffset().y-$.top;if(Y<U&&te<ee||Y>U&&te>ee)return}O(U,Y),R.index=U}}}),[{isDragging:re},X,q]=(0,p.useDrag)({type:P,item(){h&&h();const{width:R}=v.current?.getBoundingClientRect()??{};return{index:M,width:R,...b}},end(){I&&I()},canDrag:k,isDragging:b.id?R=>b.id===R.getItem().id:void 0,collect:R=>({isDragging:R.isDragging()})}),w=(0,C.A)(k,M,{onGrabItem:F,onDropItem:K,onCancel:B,onMoveItem:O});return[{handlerId:J,isDragging:re,handleKeyDown:w},v,N,X,q]}},25950:(j,L,s)=>{s.d(L,{A:()=>p});var m=s(67294);const p=(A,C,{onCancel:S,onDropItem:k,onGrabItem:P,onMoveItem:M})=>{const[b,h]=(0,m.useState)(!1),I=O=>{b&&(O==="UP"?M(C-1,C):O==="DOWN"&&M(C+1,C))},F=()=>{b?(k&&k(C),h(!1)):(P&&P(C),h(!0))},K=()=>{b&&(h(!1),S&&S(C))};return O=>{if(A&&!(O.key==="Tab"&&!b))switch(O.preventDefault(),O.key){case" ":case"Enter":F();break;case"Escape":K();break;case"ArrowDown":case"ArrowRight":I("DOWN");break;case"ArrowUp":case"ArrowLeft":I("UP");break;default:}}}},42225:(j,L,s)=>{s.d(L,{Jg:()=>M,KQ:()=>k,Vo:()=>P,Yg:()=>A});var m=s(20573),p=s(23301);const A=()=>h=>h["content-manager_app"]||p.E,C=()=>createSelector(A(),h=>h),S=()=>createSelector(A(),h=>h.models),k=()=>(0,m.P1)(A(),h=>({collectionTypeLinks:h.collectionTypeLinks,singleTypeLinks:h.singleTypeLinks})),P=()=>(0,m.P1)(A(),({components:h,models:I})=>({schemas:[...h,...I]})),M=(0,m.P1)(A(),h=>h.fieldSizes);var b=null},25398:(j,L,s)=>{s.d(L,{Z:()=>p});const p=A=>A["content-manager_editViewLayoutManager"].currentLayout},56837:(j,L,s)=>{s.d(L,{Z:()=>m});const m={COMPONENT:"component",EDIT_FIELD:"editField",FIELD:"field",DYNAMIC_ZONE:"dynamicZone",RELATION:"relation"}},45283:(j,L,s)=>{s.d(L,{Z:()=>p});const p=A=>`content-manager.${A}`},44949:(j,L,s)=>{s.d(L,{_Q:()=>te.Z,W3:()=>C,ko:()=>M,FE:()=>h,Di:()=>B,Ex:()=>me,du:()=>J,TA:()=>X,Ts:()=>_,Uo:()=>U,IF:()=>ee,OB:()=>oe.Z,w8:()=>z,kc:()=>ue});var m=s(50361),p=s.n(m);const C=(r,c,u)=>{if(Array.isArray(r)&&c>=0&&u>=0&&c<=r.length-1&&u<=r.length-1){const o=p()(r),d=o.splice(c,1);return o.splice(u,0,d[0]),o}return r};var S=s(7334),k=s.n(S);const M=r=>{const c=r.type;return c==="relation"?!k()(r.relationType).includes("morph"):!["json","dynamiczone","richtext","password"].includes(c)&&!!c},b=(r,c)=>{typeof r=="function"?r(c):r!=null&&(r.current=c)},h=(...r)=>c=>r.forEach(u=>b(u,c));var I=s(27361),F=s.n(I);const K=(r,c)=>Object.keys(r).reduce((u,o)=>{const d=F()(r,[o],{}),{default:n,component:e,type:t,required:i,min:l,repeatable:a}=d;if(n!==void 0&&(u[o]=n),t==="component"){const f=c?.[e]?.attributes??{},g=K(f,c);if(i===!0&&(u[o]=a===!0?[]:g),l&&a===!0&&i){u[o]=[];for(let D=0;D<l;D+=1)u[o].push(g)}}return t==="dynamiczone"&&i===!0&&(u[o]=[]),u},{}),B=K;var O=s(57557),H=s.n(O);const J=({layouts:r,metadatas:c,...u})=>{const o=r.list.map(e=>e.name?e.name:e),d=Object.keys(c).reduce((e,t)=>{const i=F()(c,[t],{});let l=i.edit;return l.mainField&&(l={...l,mainField:i.edit.mainField.name}),{...e,[t]:{edit:l,list:H()(i.list,["mainField"])}}},{}),n=r.edit.map(e=>e.map(({name:t,size:i})=>({name:t,size:i})));return{...u,layouts:{edit:n,list:o},metadatas:d}},N=(r,c)=>r.map(u=>({...u,subject:c})),X=r=>{const c={create:[{action:"plugin::content-manager.explorer.create",subject:null}],delete:[{action:"plugin::content-manager.explorer.delete",subject:null}],publish:[{action:"plugin::content-manager.explorer.publish",subject:null}],read:[{action:"plugin::content-manager.explorer.read",subject:null}],update:[{action:"plugin::content-manager.explorer.update",subject:null}]};return Object.keys(c).reduce((u,o)=>(u[o]=N(c[o],r),u),{})};var q=s(7654),w=s.n(q);const _=r=>r.split(".").filter(c=>w()(parseInt(c,10))),U=r=>{if(r.length===0)return-1;const c=Math.max.apply(Math,r.map(u=>u.__temp_key__??0));return Number.isNaN(c)?-1:c},ee=r=>`/content-manager/${r}`;var oe=s(45283),te=s(56837),ae=s(36968),ie=s.n(ae);const z=(r,c,u)=>{const o=t=>c.find(i=>i.uid===t),d=Object.assign({},r),n=r[u].uid,e=o(n);return ie()(d,[u],{...r[u],...e}),Object.keys(r.components).forEach(t=>{const i=o(t);ie()(d,["components",t],{...r.components[t],...i})}),d};var y=s(57993);const ue=(r,c,u)=>{const o=(d,n)=>Object.keys(d).reduce((e,t)=>{const i=(0,y.UN)(n,t),l=F()(d,t),a=(0,y.k2)(n,[t,"component"]),f=(0,y.k2)(n,[t,"repeatable"]);return i==="dynamiczone"?(e[t]=l.map(g=>o(g,u[g.__component])),e):i==="component"?(f?e[t]=l&&l.map(g=>o(g,u[a])):e[t]=l&&o(l,u[a]),e):(i!=="password"&&(e[t]=l),e)},{});return o(r,c)};var ge=s(51584),le=s.n(ge),pe=s(41609),V=s.n(pe),he=s(14841),Z=s.n(he),T=s(87561),G=s(72262);T.kM(T.nK,"defined",function(){return this.test("defined",y.I0.required,r=>r!==void 0)}),T.kM(T.IX,"notEmptyMin",function(r){return this.test("notEmptyMin",y.I0.min,c=>V()(c)?!0:c.length>=r)}),T.kM(T.Z_,"isInferior",function(r,c){return this.test("isInferior",r,function(u){return!u||Number.isNaN(Z()(u))?!0:Z()(c)>=Z()(u)})}),T.kM(T.Z_,"isSuperior",function(r,c){return this.test("isSuperior",r,function(u){return!u||Number.isNaN(Z()(u))?!0:Z()(u)>=Z()(c)})});const ce=r=>F()(r,["attributes"],{}),ne=(r,{components:c},u={isCreatingEntry:!0,isDraft:!0,isFromComponent:!1})=>{const o=ce(r);return T.Ry().shape(Object.keys(o).reduce((d,n)=>{const e=o[n];if(e.type!=="relation"&&e.type!=="component"&&e.type!=="dynamiczone"){const t=de(e.type,e,u);d[n]=t}if(e.type==="relation"&&(d[n]=["oneWay","oneToOne","manyToOne","oneToManyMorph","oneToOneMorph"].includes(e.relationType)?T.Ry().nullable():T.IX().nullable()),e.type==="component"){const t=ne(c[e.component],{components:c},{...u,isFromComponent:!0});if(e.repeatable===!0){const{min:l,max:a,required:f}=e;let g=T.Vo(D=>{let E=T.IX().of(t);return l?f?E=E.min(l,y.I0.min):f!==!0&&V()(D)?E=E.nullable():E=E.min(l,y.I0.min):f&&!u.isDraft&&(E=E.min(1,y.I0.required)),a&&(E=E.max(a,y.I0.max)),E});return d[n]=g,d}const i=T.Vo(l=>l!==void 0?e.required===!0&&!u.isDraft?t.defined():t.nullable():e.required===!0?T.Ry().defined():T.Ry().nullable());return d[n]=i,d}if(e.type==="dynamiczone"){let t=T.IX().of(T.Vo(({__component:a})=>ne(c[a],{components:c},{...u,isFromComponent:!0})));const{max:i,min:l}=e;l?e.required?t=t.test("min",y.I0.min,a=>u.isCreatingEntry?a&&a.length>=l:a===void 0?!0:a!==null&&a.length>=l).test("required",y.I0.required,a=>u.isCreatingEntry?a!==null||a!==void 0:a===void 0?!0:a!==null):t=t.notEmptyMin(l):e.required&&!u.isDraft&&(t=t.test("required",y.I0.required,a=>u.isCreatingEntry?a!==null||a!==void 0:a===void 0?!0:a!==null)),i&&(t=t.max(i,y.I0.max)),d[n]=t}return d},{}))},de=(r,c,u)=>{let o=T.nK();return["string","uid","text","richtext","email","password","enumeration"].includes(r)&&(o=T.Z_()),r==="json"&&(o=T.nK(y.I0.json).test("isJSON",y.I0.json,d=>{if(!d||!d.length)return!0;try{return JSON.parse(d),!0}catch{return!1}}).nullable().test("required",y.I0.required,d=>!(c.required&&(!d||!d.length)))),r==="email"&&(o=o.email(y.I0.email)),["number","integer","float","decimal"].includes(r)&&(o=T.Rx().transform(d=>w()(d)?void 0:d).typeError()),r==="biginteger"&&(o=T.Z_().matches(/^-?\d*$/)),["date","datetime"].includes(r)&&(o=T.hT()),Object.keys(c).forEach(d=>{const n=c[d];if(n||!le()(n)&&Number.isInteger(Math.floor(n))||n===0)switch(d){case"required":{u.isDraft||(r==="password"&&u.isCreatingEntry&&(o=o.required(y.I0.required)),r!=="password"&&(u.isCreatingEntry?o=o.required(y.I0.required):o=o.test("required",y.I0.required,e=>e===void 0&&!u.isFromComponent?!0:(0,G.Z)(r)?e===0?!0:!!e:r==="boolean"?e!=null:r==="date"||r==="datetime"?typeof e=="string"?!V()(e):!V()(e?.toString()):!V()(e))));break}case"max":{r==="biginteger"?o=o.isInferior(y.I0.max,n):o=o.max(n,y.I0.max);break}case"maxLength":o=o.max(n,y.I0.maxLength);break;case"min":{r==="biginteger"?o=o.isSuperior(y.I0.min,n):o=o.min(n,y.I0.min);break}case"minLength":{u.isDraft||(o=o.min(n,y.I0.minLength));break}case"regex":o=o.matches(new RegExp(n),{message:y.I0.regex,excludeEmptyString:!c.required});break;case"lowercase":["text","textarea","email","string"].includes(r)&&(o=o.strict().lowercase());break;case"uppercase":["text","textarea","email","string"].includes(r)&&(o=o.strict().uppercase());break;case"positive":(0,G.Z)(r)&&(o=o.positive());break;case"negative":(0,G.Z)(r)&&(o=o.negative());break;default:o=o.nullable()}}),o},me=ne},72262:(j,L,s)=>{s.d(L,{Z:()=>m});function m(p){return["integer","biginteger","decimal","float","number"].includes(p)}}}]);
